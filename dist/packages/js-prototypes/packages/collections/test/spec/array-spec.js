"use strict";
require("collections/shim");
require("collections/listen/array-changes");
var GenericCollection = require("collections/generic-collection");
var describeDeque = require("./deque");
var describeCollection = require("./collection");
var describeOrder = require("./order");
var describeMapChanges = require("./listen/map-changes");
describe("Array-spec", function () {
    describeDeque(Array.from);
    describeCollection(Array, [1, 2, 3, 4]);
    describeCollection(Array, [{ id: 0 }, { id: 1 }, { id: 2 }, { id: 3 }]);
    describeOrder(Array.from);
    function mapAlike(entries) {
        var array = [];
        if (entries) {
            entries.forEach(function (pair) {
                array.set(pair[0], pair[1]);
            });
        }
        return array;
    }
    describeMapChanges(mapAlike);
    /*
        The following tests are from Montage.
        Copyright (c) 2012, Motorola Mobility LLC.
        All Rights Reserved.
        BSD License.
    */
    // contains 10, 20, 30
    function FakeArray() {
        this.length = 3;
    }
    Object.addEach(FakeArray.prototype, GenericCollection.prototype);
    FakeArray.prototype.reduce = function (callback, basis) {
        basis = callback(basis, 10, 0, this);
        basis = callback(basis, 20, 1, this);
        basis = callback(basis, 30, 2, this);
        return basis;
    };
    var fakeArray = new FakeArray();
    // should have been almost completely tested by Object.equals and
    // describeOrder
    // get does not work the same way as most other ordered collections.  it
    // behaves like a map of indicies to values.  others behave like sets.
    describe("get", function () {
        it("should return the value for a given index", function () {
            expect([0].get(0)).toEqual(0);
        });
        it("should not return a named property", function () {
            expect(function () {
                [].get("length");
            }).toThrow();
        });
        it("should not return a named index", function () {
            expect(function () {
                [].get("0");
            }).toThrow();
        });
    });
    // Since these are brute force sought, they do not need to be comparable
    // for arrays, like they would for a SortedArray.  These tests would apply
    // to lists as well, but lists do not have indicies.
    describe("find", function () {
        it("should find an object in an array by one of its properties", function () {
            var inventory = [
                { name: 'apples', quantity: 2 },
                { name: 'bananas', quantity: 0 },
                { name: 'cherries', quantity: 5 }
            ];
            function isCherries(fruit) {
                return fruit.name === 'cherries';
            }
            expect(inventory.find(isCherries)).toEqual(inventory[2]);
        });
        describe("find (deprecated support)", function () {
            it("should find equivalent objects", function () {
                expect([{ a: 10 }].find({ a: 10 })).toEqual(0);
            });
            it("should allow equality comparison override", function () {
                expect([{ a: 10 }].find({ a: 10 }, Object.is)).toEqual(-1);
            });
        });
    });
    describe("findValue", function () {
        it("should find equivalent objects", function () {
            expect([{ a: 10 }].findValue({ a: 10 })).toEqual(0);
        });
        it("should allow equality comparison override", function () {
            expect([{ a: 10 }].findValue({ a: 10 }, Object.is)).toEqual(-1);
        });
    });
    describe("findLast (deprecated support)", function () {
        it("should find equivalent objects", function () {
            expect([{ a: 10 }].findLast({ a: 10 })).toEqual(0);
        });
        it("should allow equality comparison override", function () {
            expect([{ a: 10 }].findLast({ a: 10 }, Object.is)).toEqual(-1);
        });
        it("should find the last of equivalent objects", function () {
            var object = { a: 10 };
            expect([object, { a: 10 }].findLast(object)).toEqual(1);
        });
    });
    describe("findLastValue", function () {
        it("should find equivalent objects", function () {
            expect([{ a: 10 }].findLastValue({ a: 10 })).toEqual(0);
        });
        it("should allow equality comparison override", function () {
            expect([{ a: 10 }].findLastValue({ a: 10 }, Object.is)).toEqual(-1);
        });
        it("should find the last of equivalent objects", function () {
            var object = { a: 10 };
            expect([object, { a: 10 }].findLastValue(object)).toEqual(1);
        });
    });
    describe("has", function () {
        it("should find equivalent objects", function () {
            expect([{ a: 10 }].has({ a: 10 })).toBe(true);
        });
        it("should not find non-contained values", function () {
            expect([].has(-1)).toBe(false);
        });
        it("should allow equality comparison override", function () {
            var object = {};
            expect([{}].has(object, Object.is)).toBe(false);
            expect([object].has(object, Object.is)).toBe(true);
        });
    });
    describe("add", function () {
        it("should add values", function () {
            var array = [{ a: 10 }];
            array.add({ a: 10 });
            expect(array[0]).toEqual({ a: 10 });
            expect(array[1]).toEqual({ a: 10 });
            expect(array.has({ a: 10 })).toBe(true);
        });
    });
    describe("sorted", function () {
        var a = { foo: [1, 4] }, b = { foo: [2, 3] }, c = { foo: [2, 3] }, d = { foo: [3, 2] }, e = { foo: [4] }, unsorted = [d, b, c, a, e], // b and c equal, in stable order
        sorted = [a, b, c, d, e], byFoo = Function.by(function (x) {
            return x.foo;
        });
        it("should not be an in-place sort", function () {
            expect(unsorted.sorted()).not.toBe(unsorted);
        });
        it("should sort objects by a property array", function () {
            expect(unsorted.sorted(byFoo)).toEqual(sorted);
            unsorted.sorted(byFoo).forEach(function (x, i) {
                expect(x).toBe(sorted[i]);
            });
        });
    });
    describe("clone", function () {
        // should have been adequately covered by Object.clone tests
        it("should clone with indefinite depth", function () {
            var array = [[[]]];
            var clone = array.clone();
            expect(clone).toEqual(array);
            expect(clone).not.toBe(array);
        });
        it("should clone with depth 0", function () {
            var array = [];
            expect(array.clone(0)).toBe(array);
        });
        it("should clone with depth 1", function () {
            var array = [{}];
            expect(array.clone(1)).not.toBe(array);
            expect(array.clone(1)[0]).toBe(array[0]);
        });
        it("should clone with depth 2", function () {
            var array = [{ a: 10 }];
            expect(array.clone(2)).not.toBe(array);
            expect(array.clone(2)[0]).not.toBe(array[0]);
            expect(array.clone(2)[0]).toEqual(array[0]);
        });
    });
    describe("zip", function () {
        it("should treat holes as undefined", function () {
            var a = [0, 1];
            var b = [];
            b[1] = 'b';
            expect(a.zip(b)).toEqual([
                [0],
                [1, 'b']
            ]);
        });
    });
    describe("group", function () {
        it("should make a histogram", function () {
            var groups = [
                { x: 0 },
                { x: 1 },
                { x: 2 },
                { x: 3 }
            ].group(function (object) {
                return Math.floor(object.x / 2);
            });
            expect(groups).toEqual([
                [0, [{ x: 0 }, { x: 1 }]],
                [1, [{ x: 2 }, { x: 3 }]]
            ]);
        });
    });
    describe("swap", function () {
        var array, otherArray;
        beforeEach(function () {
            array = [1, 2, 3];
        });
        it("should be able to replace content with content of another arraylike", function () {
            otherArray = { __proto__: Array.prototype };
            otherArray[0] = 4;
            otherArray[1] = 5;
            otherArray.length = 2;
            array.swap(0, array.length, otherArray);
            expect(array).toEqual([4, 5]);
        });
        it("should ignore non array like plus value", function () {
            array.swap(0, array.length, 4);
            expect(array).toEqual([]);
        });
        it("should ignore extra arguments", function () {
            array.swap(0, array.length, 4, 5, 6);
            expect(array).toEqual([]);
        });
        it("should work with large arrays", function () {
            otherArray = new Array(200000);
            expect(function () {
                array.swap(0, array.length, otherArray);
            }).not.toThrow();
            expect(array.length).toEqual(200000);
        });
        it("swaps at an outer index", function () {
            array.swap(4, 0, [5]);
            expect(array).toEqual([1, 2, 3, , 5]);
        });
    });
    describe("set", function () {
        it("sets an inner index", function () {
            var array = [1, 2, 3];
            array.set(1, 10);
            expect(array).toEqual([1, 10, 3]);
        });
        it("sets an inner index of an observed array", function () {
            var array = [1, 2, 3];
            array.makeObservable();
            array.set(1, 10);
            expect(array).toEqual([1, 10, 3]);
        });
        it("sets an outer index", function () {
            var array = [];
            array.set(4, 10);
            expect(array).toEqual([, , , , 10]);
        });
        it("sets an outer index of an observed array", function () {
            var array = [];
            array.makeObservable();
            array.set(4, 10);
            expect(array).toEqual([, , , , 10]);
        });
    });
    describe("deleteAll", function () {
        it("should delete a range of equivalent values", function () {
            var array = [1, 1, 1, 2, 2, 2, 3, 3, 3];
            expect(array.deleteAll(2)).toBe(3);
            expect(array).toEqual([1, 1, 1, 3, 3, 3]);
        });
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXJyYXktc3BlYy5qcyIsInNvdXJjZVJvb3QiOiIuLyIsInNvdXJjZXMiOlsicGFja2FnZXMvanMtcHJvdG90eXBlcy9wYWNrYWdlcy9jb2xsZWN0aW9ucy90ZXN0L3NwZWMvYXJyYXktc3BlYy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxDQUFDLGtCQUFrQixDQUFDLENBQUM7QUFDNUIsT0FBTyxDQUFDLGtDQUFrQyxDQUFDLENBQUM7QUFDNUMsSUFBSSxpQkFBaUIsR0FBRyxPQUFPLENBQUMsZ0NBQWdDLENBQUMsQ0FBQztBQUNsRSxJQUFJLGFBQWEsR0FBRyxPQUFPLENBQUMsU0FBUyxDQUFDLENBQUM7QUFDdkMsSUFBSSxrQkFBa0IsR0FBRyxPQUFPLENBQUMsY0FBYyxDQUFDLENBQUM7QUFDakQsSUFBSSxhQUFhLEdBQUcsT0FBTyxDQUFDLFNBQVMsQ0FBQyxDQUFDO0FBQ3ZDLElBQUksa0JBQWtCLEdBQUcsT0FBTyxDQUFDLHNCQUFzQixDQUFDLENBQUM7QUFFekQsUUFBUSxDQUFDLFlBQVksRUFBRTtJQUNuQixhQUFhLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQzFCLGtCQUFrQixDQUFDLEtBQUssRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDeEMsa0JBQWtCLENBQUMsS0FBSyxFQUFFLENBQUMsRUFBQyxFQUFFLEVBQUUsQ0FBQyxFQUFDLEVBQUUsRUFBQyxFQUFFLEVBQUUsQ0FBQyxFQUFDLEVBQUUsRUFBQyxFQUFFLEVBQUUsQ0FBQyxFQUFDLEVBQUUsRUFBQyxFQUFFLEVBQUUsQ0FBQyxFQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ2hFLGFBQWEsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUM7SUFFMUIsU0FBUyxRQUFRLENBQUMsT0FBTztRQUNyQixJQUFJLEtBQUssR0FBRyxFQUFFLENBQUM7UUFDZixJQUFJLE9BQU8sRUFBRTtZQUNULE9BQU8sQ0FBQyxPQUFPLENBQUMsVUFBVSxJQUFJO2dCQUMxQixLQUFLLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUNoQyxDQUFDLENBQUMsQ0FBQztTQUNOO1FBQ0QsT0FBTyxLQUFLLENBQUM7SUFDakIsQ0FBQztJQUVELGtCQUFrQixDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBRTdCOzs7OztNQUtFO0lBRUYsc0JBQXNCO0lBQ3RCLFNBQVMsU0FBUztRQUNkLElBQUksQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDO0lBQ3BCLENBQUM7SUFDRCxNQUFNLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBQyxTQUFTLEVBQUUsaUJBQWlCLENBQUMsU0FBUyxDQUFDLENBQUM7SUFDakUsU0FBUyxDQUFDLFNBQVMsQ0FBQyxNQUFNLEdBQUcsVUFBVSxRQUFRLEVBQUUsS0FBSztRQUNsRCxLQUFLLEdBQUcsUUFBUSxDQUFDLEtBQUssRUFBRSxFQUFFLEVBQUUsQ0FBQyxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQ3JDLEtBQUssR0FBRyxRQUFRLENBQUMsS0FBSyxFQUFFLEVBQUUsRUFBRSxDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDckMsS0FBSyxHQUFHLFFBQVEsQ0FBQyxLQUFLLEVBQUUsRUFBRSxFQUFFLENBQUMsRUFBRSxJQUFJLENBQUMsQ0FBQztRQUNyQyxPQUFPLEtBQUssQ0FBQztJQUNqQixDQUFDLENBQUM7SUFDRixJQUFJLFNBQVMsR0FBRyxJQUFJLFNBQVMsRUFBRSxDQUFDO0lBRWhDLGlFQUFpRTtJQUNqRSxnQkFBZ0I7SUFFaEIsd0VBQXdFO0lBQ3hFLHNFQUFzRTtJQUN0RSxRQUFRLENBQUMsS0FBSyxFQUFFO1FBRVosRUFBRSxDQUFDLDJDQUEyQyxFQUFFO1lBQzVDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNsQyxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxvQ0FBb0MsRUFBRTtZQUNyQyxNQUFNLENBQUM7Z0JBQ0gsRUFBRSxDQUFDLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUNyQixDQUFDLENBQUMsQ0FBQyxPQUFPLEVBQUUsQ0FBQztRQUNqQixDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxpQ0FBaUMsRUFBRTtZQUNsQyxNQUFNLENBQUM7Z0JBQ0gsRUFBRSxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUNoQixDQUFDLENBQUMsQ0FBQyxPQUFPLEVBQUUsQ0FBQztRQUNqQixDQUFDLENBQUMsQ0FBQztJQUVQLENBQUMsQ0FBQyxDQUFDO0lBRUgsd0VBQXdFO0lBQ3hFLDBFQUEwRTtJQUMxRSxvREFBb0Q7SUFFcEQsUUFBUSxDQUFDLE1BQU0sRUFBRTtRQUViLEVBQUUsQ0FBQyw0REFBNEQsRUFBRTtZQUM3RCxJQUFJLFNBQVMsR0FBRztnQkFDWixFQUFDLElBQUksRUFBRSxRQUFRLEVBQUUsUUFBUSxFQUFFLENBQUMsRUFBQztnQkFDN0IsRUFBQyxJQUFJLEVBQUUsU0FBUyxFQUFFLFFBQVEsRUFBRSxDQUFDLEVBQUM7Z0JBQzlCLEVBQUMsSUFBSSxFQUFFLFVBQVUsRUFBRSxRQUFRLEVBQUUsQ0FBQyxFQUFDO2FBQ2xDLENBQUM7WUFFRixTQUFTLFVBQVUsQ0FBQyxLQUFLO2dCQUNyQixPQUFPLEtBQUssQ0FBQyxJQUFJLEtBQUssVUFBVSxDQUFDO1lBQ3JDLENBQUM7WUFFRCxNQUFNLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUM3RCxDQUFDLENBQUMsQ0FBQztRQUVILFFBQVEsQ0FBQywyQkFBMkIsRUFBRTtZQUVsQyxFQUFFLENBQUMsZ0NBQWdDLEVBQUU7Z0JBQ2pDLE1BQU0sQ0FBQyxDQUFDLEVBQUMsQ0FBQyxFQUFDLEVBQUUsRUFBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUMsQ0FBQyxFQUFDLEVBQUUsRUFBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDN0MsQ0FBQyxDQUFDLENBQUM7WUFFSCxFQUFFLENBQUMsMkNBQTJDLEVBQUU7Z0JBQzVDLE1BQU0sQ0FBQyxDQUFDLEVBQUMsQ0FBQyxFQUFDLEVBQUUsRUFBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUMsQ0FBQyxFQUFDLEVBQUUsRUFBQyxFQUFFLE1BQU0sQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ3pELENBQUMsQ0FBQyxDQUFDO1FBQ1AsQ0FBQyxDQUFDLENBQUM7SUFFUCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxXQUFXLEVBQUU7UUFFbEIsRUFBRSxDQUFDLGdDQUFnQyxFQUFFO1lBQ2pDLE1BQU0sQ0FBQyxDQUFDLEVBQUMsQ0FBQyxFQUFDLEVBQUUsRUFBQyxDQUFDLENBQUMsU0FBUyxDQUFDLEVBQUMsQ0FBQyxFQUFDLEVBQUUsRUFBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDbEQsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsMkNBQTJDLEVBQUU7WUFDNUMsTUFBTSxDQUFDLENBQUMsRUFBQyxDQUFDLEVBQUMsRUFBRSxFQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsRUFBQyxDQUFDLEVBQUMsRUFBRSxFQUFDLEVBQUUsTUFBTSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDOUQsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQywrQkFBK0IsRUFBRTtRQUV0QyxFQUFFLENBQUMsZ0NBQWdDLEVBQUU7WUFDakMsTUFBTSxDQUFDLENBQUMsRUFBQyxDQUFDLEVBQUMsRUFBRSxFQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsRUFBQyxDQUFDLEVBQUMsRUFBRSxFQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNqRCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQywyQ0FBMkMsRUFBRTtZQUM1QyxNQUFNLENBQUMsQ0FBQyxFQUFDLENBQUMsRUFBQyxFQUFFLEVBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxFQUFDLENBQUMsRUFBQyxFQUFFLEVBQUMsRUFBRSxNQUFNLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUM3RCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyw0Q0FBNEMsRUFBRTtZQUM3QyxJQUFJLE1BQU0sR0FBRyxFQUFDLENBQUMsRUFBRSxFQUFFLEVBQUMsQ0FBQztZQUNyQixNQUFNLENBQUMsQ0FBQyxNQUFNLEVBQUUsRUFBQyxDQUFDLEVBQUUsRUFBRSxFQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDMUQsQ0FBQyxDQUFDLENBQUM7SUFFUCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxlQUFlLEVBQUU7UUFFdEIsRUFBRSxDQUFDLGdDQUFnQyxFQUFFO1lBQ2pDLE1BQU0sQ0FBQyxDQUFDLEVBQUMsQ0FBQyxFQUFDLEVBQUUsRUFBQyxDQUFDLENBQUMsYUFBYSxDQUFDLEVBQUMsQ0FBQyxFQUFDLEVBQUUsRUFBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDdEQsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsMkNBQTJDLEVBQUU7WUFDNUMsTUFBTSxDQUFDLENBQUMsRUFBQyxDQUFDLEVBQUMsRUFBRSxFQUFDLENBQUMsQ0FBQyxhQUFhLENBQUMsRUFBQyxDQUFDLEVBQUMsRUFBRSxFQUFDLEVBQUUsTUFBTSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDbEUsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsNENBQTRDLEVBQUU7WUFDN0MsSUFBSSxNQUFNLEdBQUcsRUFBQyxDQUFDLEVBQUUsRUFBRSxFQUFDLENBQUM7WUFDckIsTUFBTSxDQUFDLENBQUMsTUFBTSxFQUFFLEVBQUMsQ0FBQyxFQUFFLEVBQUUsRUFBQyxDQUFDLENBQUMsYUFBYSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQy9ELENBQUMsQ0FBQyxDQUFDO0lBRVAsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsS0FBSyxFQUFFO1FBRVosRUFBRSxDQUFDLGdDQUFnQyxFQUFFO1lBQ2pDLE1BQU0sQ0FBQyxDQUFDLEVBQUMsQ0FBQyxFQUFFLEVBQUUsRUFBQyxDQUFDLENBQUMsR0FBRyxDQUFDLEVBQUMsQ0FBQyxFQUFFLEVBQUUsRUFBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDOUMsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsc0NBQXNDLEVBQUU7WUFDdkMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUNuQyxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQywyQ0FBMkMsRUFBRTtZQUM1QyxJQUFJLE1BQU0sR0FBRyxFQUFFLENBQUM7WUFDaEIsTUFBTSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsR0FBRyxDQUFDLE1BQU0sRUFBRSxNQUFNLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDaEQsTUFBTSxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsR0FBRyxDQUFDLE1BQU0sRUFBRSxNQUFNLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDdkQsQ0FBQyxDQUFDLENBQUM7SUFFUCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxLQUFLLEVBQUU7UUFFWixFQUFFLENBQUMsbUJBQW1CLEVBQUU7WUFDcEIsSUFBSSxLQUFLLEdBQUcsQ0FBQyxFQUFDLENBQUMsRUFBRSxFQUFFLEVBQUMsQ0FBQyxDQUFDO1lBQ3RCLEtBQUssQ0FBQyxHQUFHLENBQUMsRUFBQyxDQUFDLEVBQUUsRUFBRSxFQUFDLENBQUMsQ0FBQztZQUNuQixNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLEVBQUMsQ0FBQyxFQUFFLEVBQUUsRUFBQyxDQUFDLENBQUM7WUFDbEMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxFQUFDLENBQUMsRUFBRSxFQUFFLEVBQUMsQ0FBQyxDQUFDO1lBQ2xDLE1BQU0sQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLEVBQUMsQ0FBQyxFQUFFLEVBQUUsRUFBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDMUMsQ0FBQyxDQUFDLENBQUM7SUFFUCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxRQUFRLEVBQUU7UUFDZixJQUFJLENBQUMsR0FBRyxFQUFDLEdBQUcsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBQyxFQUNqQixDQUFDLEdBQUcsRUFBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUMsRUFDakIsQ0FBQyxHQUFHLEVBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFDLEVBQ2pCLENBQUMsR0FBRyxFQUFDLEdBQUcsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBQyxFQUNqQixDQUFDLEdBQUcsRUFBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBQyxFQUNkLFFBQVEsR0FBRyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxpQ0FBaUM7UUFDN0QsTUFBTSxHQUFHLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUN4QixLQUFLLEdBQUcsUUFBUSxDQUFDLEVBQUUsQ0FBQyxVQUFVLENBQUM7WUFDM0IsT0FBTyxDQUFDLENBQUMsR0FBRyxDQUFDO1FBQ2pCLENBQUMsQ0FBQyxDQUFDO1FBRVAsRUFBRSxDQUFDLGdDQUFnQyxFQUFFO1lBQ2pDLE1BQU0sQ0FBQyxRQUFRLENBQUMsTUFBTSxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQ2pELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHlDQUF5QyxFQUFFO1lBQzFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBQy9DLFFBQVEsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxFQUFFLENBQUM7Z0JBQ3pDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDOUIsQ0FBQyxDQUFDLENBQUM7UUFDUCxDQUFDLENBQUMsQ0FBQztJQUVQLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLE9BQU8sRUFBRTtRQUVkLDREQUE0RDtRQUU1RCxFQUFFLENBQUMsb0NBQW9DLEVBQUU7WUFDckMsSUFBSSxLQUFLLEdBQUcsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7WUFDbkIsSUFBSSxLQUFLLEdBQUcsS0FBSyxDQUFDLEtBQUssRUFBRSxDQUFDO1lBQzFCLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDN0IsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDbEMsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsMkJBQTJCLEVBQUU7WUFDNUIsSUFBSSxLQUFLLEdBQUcsRUFBRSxDQUFDO1lBQ2YsTUFBTSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDdkMsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsMkJBQTJCLEVBQUU7WUFDNUIsSUFBSSxLQUFLLEdBQUcsQ0FBQyxFQUFFLENBQUMsQ0FBQztZQUNqQixNQUFNLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDdkMsTUFBTSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDN0MsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsMkJBQTJCLEVBQUU7WUFDNUIsSUFBSSxLQUFLLEdBQUcsQ0FBQyxFQUFDLENBQUMsRUFBRSxFQUFFLEVBQUMsQ0FBQyxDQUFDO1lBQ3RCLE1BQU0sQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUN2QyxNQUFNLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDN0MsTUFBTSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFD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RUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO1lBQ3hDLE1BQU0sQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ25DLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDOUMsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDLENBQUMsQ0FBQztBQUVQLENBQUMsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsicmVxdWlyZShcImNvbGxlY3Rpb25zL3NoaW1cIik7XG5yZXF1aXJlKFwiY29sbGVjdGlvbnMvbGlzdGVuL2FycmF5LWNoYW5nZXNcIik7XG52YXIgR2VuZXJpY0NvbGxlY3Rpb24gPSByZXF1aXJlKFwiY29sbGVjdGlvbnMvZ2VuZXJpYy1jb2xsZWN0aW9uXCIpO1xudmFyIGRlc2NyaWJlRGVxdWUgPSByZXF1aXJlKFwiLi9kZXF1ZVwiKTtcbnZhciBkZXNjcmliZUNvbGxlY3Rpb24gPSByZXF1aXJlKFwiLi9jb2xsZWN0aW9uXCIpO1xudmFyIGRlc2NyaWJlT3JkZXIgPSByZXF1aXJlKFwiLi9vcmRlclwiKTtcbnZhciBkZXNjcmliZU1hcENoYW5nZXMgPSByZXF1aXJlKFwiLi9saXN0ZW4vbWFwLWNoYW5nZXNcIik7XG5cbmRlc2NyaWJlKFwiQXJyYXktc3BlY1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgZGVzY3JpYmVEZXF1ZShBcnJheS5mcm9tKTtcbiAgICBkZXNjcmliZUNvbGxlY3Rpb24oQXJyYXksIFsxLCAyLCAzLCA0XSk7XG4gICAgZGVzY3JpYmVDb2xsZWN0aW9uKEFycmF5LCBbe2lkOiAwfSwge2lkOiAxfSwge2lkOiAyfSwge2lkOiAzfV0pO1xuICAgIGRlc2NyaWJlT3JkZXIoQXJyYXkuZnJvbSk7XG5cbiAgICBmdW5jdGlvbiBtYXBBbGlrZShlbnRyaWVzKSB7XG4gICAgICAgIHZhciBhcnJheSA9IFtdO1xuICAgICAgICBpZiAoZW50cmllcykge1xuICAgICAgICAgICAgZW50cmllcy5mb3JFYWNoKGZ1bmN0aW9uIChwYWlyKSB7XG4gICAgICAgICAgICAgICAgYXJyYXkuc2V0KHBhaXJbMF0sIHBhaXJbMV0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFycmF5O1xuICAgIH1cblxuICAgIGRlc2NyaWJlTWFwQ2hhbmdlcyhtYXBBbGlrZSk7XG5cbiAgICAvKlxuICAgICAgICBUaGUgZm9sbG93aW5nIHRlc3RzIGFyZSBmcm9tIE1vbnRhZ2UuXG4gICAgICAgIENvcHlyaWdodCAoYykgMjAxMiwgTW90b3JvbGEgTW9iaWxpdHkgTExDLlxuICAgICAgICBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICAgICAgICBCU0QgTGljZW5zZS5cbiAgICAqL1xuXG4gICAgLy8gY29udGFpbnMgMTAsIDIwLCAzMFxuICAgIGZ1bmN0aW9uIEZha2VBcnJheSgpIHtcbiAgICAgICAgdGhpcy5sZW5ndGggPSAzO1xuICAgIH1cbiAgICBPYmplY3QuYWRkRWFjaChGYWtlQXJyYXkucHJvdG90eXBlLCBHZW5lcmljQ29sbGVjdGlvbi5wcm90b3R5cGUpO1xuICAgIEZha2VBcnJheS5wcm90b3R5cGUucmVkdWNlID0gZnVuY3Rpb24gKGNhbGxiYWNrLCBiYXNpcykge1xuICAgICAgICBiYXNpcyA9IGNhbGxiYWNrKGJhc2lzLCAxMCwgMCwgdGhpcyk7XG4gICAgICAgIGJhc2lzID0gY2FsbGJhY2soYmFzaXMsIDIwLCAxLCB0aGlzKTtcbiAgICAgICAgYmFzaXMgPSBjYWxsYmFjayhiYXNpcywgMzAsIDIsIHRoaXMpO1xuICAgICAgICByZXR1cm4gYmFzaXM7XG4gICAgfTtcbiAgICB2YXIgZmFrZUFycmF5ID0gbmV3IEZha2VBcnJheSgpO1xuXG4gICAgLy8gc2hvdWxkIGhhdmUgYmVlbiBhbG1vc3QgY29tcGxldGVseSB0ZXN0ZWQgYnkgT2JqZWN0LmVxdWFscyBhbmRcbiAgICAvLyBkZXNjcmliZU9yZGVyXG5cbiAgICAvLyBnZXQgZG9lcyBub3Qgd29yayB0aGUgc2FtZSB3YXkgYXMgbW9zdCBvdGhlciBvcmRlcmVkIGNvbGxlY3Rpb25zLiAgaXRcbiAgICAvLyBiZWhhdmVzIGxpa2UgYSBtYXAgb2YgaW5kaWNpZXMgdG8gdmFsdWVzLiAgb3RoZXJzIGJlaGF2ZSBsaWtlIHNldHMuXG4gICAgZGVzY3JpYmUoXCJnZXRcIiwgZnVuY3Rpb24gKCkge1xuXG4gICAgICAgIGl0KFwic2hvdWxkIHJldHVybiB0aGUgdmFsdWUgZm9yIGEgZ2l2ZW4gaW5kZXhcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZXhwZWN0KFswXS5nZXQoMCkpLnRvRXF1YWwoMCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KFwic2hvdWxkIG5vdCByZXR1cm4gYSBuYW1lZCBwcm9wZXJ0eVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBleHBlY3QoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIFtdLmdldChcImxlbmd0aFwiKTtcbiAgICAgICAgICAgIH0pLnRvVGhyb3coKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoXCJzaG91bGQgbm90IHJldHVybiBhIG5hbWVkIGluZGV4XCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGV4cGVjdChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgW10uZ2V0KFwiMFwiKTtcbiAgICAgICAgICAgIH0pLnRvVGhyb3coKTtcbiAgICAgICAgfSk7XG5cbiAgICB9KTtcblxuICAgIC8vIFNpbmNlIHRoZXNlIGFyZSBicnV0ZSBmb3JjZSBzb3VnaHQsIHRoZXkgZG8gbm90IG5lZWQgdG8gYmUgY29tcGFyYWJsZVxuICAgIC8vIGZvciBhcnJheXMsIGxpa2UgdGhleSB3b3VsZCBmb3IgYSBTb3J0ZWRBcnJheS4gIFRoZXNlIHRlc3RzIHdvdWxkIGFwcGx5XG4gICAgLy8gdG8gbGlzdHMgYXMgd2VsbCwgYnV0IGxpc3RzIGRvIG5vdCBoYXZlIGluZGljaWVzLlxuXG4gICAgZGVzY3JpYmUoXCJmaW5kXCIsIGZ1bmN0aW9uICgpIHtcblxuICAgICAgICBpdChcInNob3VsZCBmaW5kIGFuIG9iamVjdCBpbiBhbiBhcnJheSBieSBvbmUgb2YgaXRzIHByb3BlcnRpZXNcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGludmVudG9yeSA9IFtcbiAgICAgICAgICAgICAgICB7bmFtZTogJ2FwcGxlcycsIHF1YW50aXR5OiAyfSxcbiAgICAgICAgICAgICAgICB7bmFtZTogJ2JhbmFuYXMnLCBxdWFudGl0eTogMH0sXG4gICAgICAgICAgICAgICAge25hbWU6ICdjaGVycmllcycsIHF1YW50aXR5OiA1fVxuICAgICAgICAgICAgXTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gaXNDaGVycmllcyhmcnVpdCkgeyBcbiAgICAgICAgICAgICAgICByZXR1cm4gZnJ1aXQubmFtZSA9PT0gJ2NoZXJyaWVzJztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZXhwZWN0KGludmVudG9yeS5maW5kKGlzQ2hlcnJpZXMpKS50b0VxdWFsKGludmVudG9yeVsyXSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGRlc2NyaWJlKFwiZmluZCAoZGVwcmVjYXRlZCBzdXBwb3J0KVwiLCBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgIGl0KFwic2hvdWxkIGZpbmQgZXF1aXZhbGVudCBvYmplY3RzXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBleHBlY3QoW3thOjEwfV0uZmluZCh7YToxMH0pKS50b0VxdWFsKDApO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGl0KFwic2hvdWxkIGFsbG93IGVxdWFsaXR5IGNvbXBhcmlzb24gb3ZlcnJpZGVcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGV4cGVjdChbe2E6MTB9XS5maW5kKHthOjEwfSwgT2JqZWN0LmlzKSkudG9FcXVhbCgtMSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKFwiZmluZFZhbHVlXCIsIGZ1bmN0aW9uICgpIHtcblxuICAgICAgICBpdChcInNob3VsZCBmaW5kIGVxdWl2YWxlbnQgb2JqZWN0c1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBleHBlY3QoW3thOjEwfV0uZmluZFZhbHVlKHthOjEwfSkpLnRvRXF1YWwoMCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KFwic2hvdWxkIGFsbG93IGVxdWFsaXR5IGNvbXBhcmlzb24gb3ZlcnJpZGVcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZXhwZWN0KFt7YToxMH1dLmZpbmRWYWx1ZSh7YToxMH0sIE9iamVjdC5pcykpLnRvRXF1YWwoLTEpO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKFwiZmluZExhc3QgKGRlcHJlY2F0ZWQgc3VwcG9ydClcIiwgZnVuY3Rpb24gKCkge1xuXG4gICAgICAgIGl0KFwic2hvdWxkIGZpbmQgZXF1aXZhbGVudCBvYmplY3RzXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGV4cGVjdChbe2E6MTB9XS5maW5kTGFzdCh7YToxMH0pKS50b0VxdWFsKDApO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdChcInNob3VsZCBhbGxvdyBlcXVhbGl0eSBjb21wYXJpc29uIG92ZXJyaWRlXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGV4cGVjdChbe2E6MTB9XS5maW5kTGFzdCh7YToxMH0sIE9iamVjdC5pcykpLnRvRXF1YWwoLTEpO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdChcInNob3VsZCBmaW5kIHRoZSBsYXN0IG9mIGVxdWl2YWxlbnQgb2JqZWN0c1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgb2JqZWN0ID0ge2E6IDEwfTtcbiAgICAgICAgICAgIGV4cGVjdChbb2JqZWN0LCB7YTogMTB9XS5maW5kTGFzdChvYmplY3QpKS50b0VxdWFsKDEpO1xuICAgICAgICB9KTtcblxuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoXCJmaW5kTGFzdFZhbHVlXCIsIGZ1bmN0aW9uICgpIHtcblxuICAgICAgICBpdChcInNob3VsZCBmaW5kIGVxdWl2YWxlbnQgb2JqZWN0c1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBleHBlY3QoW3thOjEwfV0uZmluZExhc3RWYWx1ZSh7YToxMH0pKS50b0VxdWFsKDApO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdChcInNob3VsZCBhbGxvdyBlcXVhbGl0eSBjb21wYXJpc29uIG92ZXJyaWRlXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGV4cGVjdChbe2E6MTB9XS5maW5kTGFzdFZhbHVlKHthOjEwfSwgT2JqZWN0LmlzKSkudG9FcXVhbCgtMSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KFwic2hvdWxkIGZpbmQgdGhlIGxhc3Qgb2YgZXF1aXZhbGVudCBvYmplY3RzXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBvYmplY3QgPSB7YTogMTB9O1xuICAgICAgICAgICAgZXhwZWN0KFtvYmplY3QsIHthOiAxMH1dLmZpbmRMYXN0VmFsdWUob2JqZWN0KSkudG9FcXVhbCgxKTtcbiAgICAgICAgfSk7XG5cbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKFwiaGFzXCIsIGZ1bmN0aW9uICgpIHtcblxuICAgICAgICBpdChcInNob3VsZCBmaW5kIGVxdWl2YWxlbnQgb2JqZWN0c1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBleHBlY3QoW3thOiAxMH1dLmhhcyh7YTogMTB9KSkudG9CZSh0cnVlKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoXCJzaG91bGQgbm90IGZpbmQgbm9uLWNvbnRhaW5lZCB2YWx1ZXNcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZXhwZWN0KFtdLmhhcygtMSkpLnRvQmUoZmFsc2UpO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdChcInNob3VsZCBhbGxvdyBlcXVhbGl0eSBjb21wYXJpc29uIG92ZXJyaWRlXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBvYmplY3QgPSB7fTtcbiAgICAgICAgICAgIGV4cGVjdChbe31dLmhhcyhvYmplY3QsIE9iamVjdC5pcykpLnRvQmUoZmFsc2UpO1xuICAgICAgICAgICAgZXhwZWN0KFtvYmplY3RdLmhhcyhvYmplY3QsIE9iamVjdC5pcykpLnRvQmUodHJ1ZSk7XG4gICAgICAgIH0pO1xuXG4gICAgfSk7XG5cbiAgICBkZXNjcmliZShcImFkZFwiLCBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgaXQoXCJzaG91bGQgYWRkIHZhbHVlc1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgYXJyYXkgPSBbe2E6IDEwfV07XG4gICAgICAgICAgICBhcnJheS5hZGQoe2E6IDEwfSk7XG4gICAgICAgICAgICBleHBlY3QoYXJyYXlbMF0pLnRvRXF1YWwoe2E6IDEwfSk7XG4gICAgICAgICAgICBleHBlY3QoYXJyYXlbMV0pLnRvRXF1YWwoe2E6IDEwfSk7XG4gICAgICAgICAgICBleHBlY3QoYXJyYXkuaGFzKHthOiAxMH0pKS50b0JlKHRydWUpO1xuICAgICAgICB9KTtcblxuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoXCJzb3J0ZWRcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYSA9IHtmb286IFsxLCA0XX0sXG4gICAgICAgICAgICBiID0ge2ZvbzogWzIsIDNdfSxcbiAgICAgICAgICAgIGMgPSB7Zm9vOiBbMiwgM119LFxuICAgICAgICAgICAgZCA9IHtmb286IFszLCAyXX0sXG4gICAgICAgICAgICBlID0ge2ZvbzogWzRdfSxcbiAgICAgICAgICAgIHVuc29ydGVkID0gW2QsIGIsIGMsIGEsIGVdLCAvLyBiIGFuZCBjIGVxdWFsLCBpbiBzdGFibGUgb3JkZXJcbiAgICAgICAgICAgIHNvcnRlZCA9IFthLCBiLCBjLCBkLCBlXSxcbiAgICAgICAgICAgIGJ5Rm9vID0gRnVuY3Rpb24uYnkoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4geC5mb287XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICBpdChcInNob3VsZCBub3QgYmUgYW4gaW4tcGxhY2Ugc29ydFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBleHBlY3QodW5zb3J0ZWQuc29ydGVkKCkpLm5vdC50b0JlKHVuc29ydGVkKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoXCJzaG91bGQgc29ydCBvYmplY3RzIGJ5IGEgcHJvcGVydHkgYXJyYXlcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZXhwZWN0KHVuc29ydGVkLnNvcnRlZChieUZvbykpLnRvRXF1YWwoc29ydGVkKTtcbiAgICAgICAgICAgIHVuc29ydGVkLnNvcnRlZChieUZvbykuZm9yRWFjaChmdW5jdGlvbiAoeCwgaSkge1xuICAgICAgICAgICAgICAgIGV4cGVjdCh4KS50b0JlKHNvcnRlZFtpXSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKFwiY2xvbmVcIiwgZnVuY3Rpb24gKCkge1xuXG4gICAgICAgIC8vIHNob3VsZCBoYXZlIGJlZW4gYWRlcXVhdGVseSBjb3ZlcmVkIGJ5IE9iamVjdC5jbG9uZSB0ZXN0c1xuXG4gICAgICAgIGl0KFwic2hvdWxkIGNsb25lIHdpdGggaW5kZWZpbml0ZSBkZXB0aFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgYXJyYXkgPSBbW1tdXV07XG4gICAgICAgICAgICB2YXIgY2xvbmUgPSBhcnJheS5jbG9uZSgpO1xuICAgICAgICAgICAgZXhwZWN0KGNsb25lKS50b0VxdWFsKGFycmF5KTtcbiAgICAgICAgICAgIGV4cGVjdChjbG9uZSkubm90LnRvQmUoYXJyYXkpO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdChcInNob3VsZCBjbG9uZSB3aXRoIGRlcHRoIDBcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGFycmF5ID0gW107XG4gICAgICAgICAgICBleHBlY3QoYXJyYXkuY2xvbmUoMCkpLnRvQmUoYXJyYXkpO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdChcInNob3VsZCBjbG9uZSB3aXRoIGRlcHRoIDFcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGFycmF5ID0gW3t9XTtcbiAgICAgICAgICAgIGV4cGVjdChhcnJheS5jbG9uZSgxKSkubm90LnRvQmUoYXJyYXkpO1xuICAgICAgICAgICAgZXhwZWN0KGFycmF5LmNsb25lKDEpWzBdKS50b0JlKGFycmF5WzBdKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoXCJzaG91bGQgY2xvbmUgd2l0aCBkZXB0aCAyXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBhcnJheSA9IFt7YTogMTB9XTtcbiAgICAgICAgICAgIGV4cGVjdChhcnJheS5jbG9uZSgyKSkubm90LnRvQmUoYXJyYXkpO1xuICAgICAgICAgICAgZXhwZWN0KGFycmF5LmNsb25lKDIpWzBdKS5ub3QudG9CZShhcnJheVswXSk7XG4gICAgICAgICAgICBleHBlY3QoYXJyYXkuY2xvbmUoMilbMF0pLnRvRXF1YWwoYXJyYXlbMF0pO1xuICAgICAgICB9KTtcblxuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoXCJ6aXBcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICBpdChcInNob3VsZCB0cmVhdCBob2xlcyBhcyB1bmRlZmluZWRcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGEgPSBbMCwgMV07XG4gICAgICAgICAgICB2YXIgYiA9IFtdO1xuICAgICAgICAgICAgYlsxXSA9ICdiJztcbiAgICAgICAgICAgIGV4cGVjdChhLnppcChiKSkudG9FcXVhbChbXG4gICAgICAgICAgICAgICAgWzBdLFxuICAgICAgICAgICAgICAgIFsxLCAnYiddXG4gICAgICAgICAgICBdKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZShcImdyb3VwXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaXQoXCJzaG91bGQgbWFrZSBhIGhpc3RvZ3JhbVwiLCBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgIHZhciBncm91cHMgPSBbXG4gICAgICAgICAgICAgICAge3g6IDB9LFxuICAgICAgICAgICAgICAgIHt4OiAxfSxcbiAgICAgICAgICAgICAgICB7eDogMn0sXG4gICAgICAgICAgICAgICAge3g6IDN9XG4gICAgICAgICAgICBdLmdyb3VwKGZ1bmN0aW9uIChvYmplY3QpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gTWF0aC5mbG9vcihvYmplY3QueCAvIDIpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIGV4cGVjdChncm91cHMpLnRvRXF1YWwoW1xuICAgICAgICAgICAgICAgIFswLCBbe3g6IDB9LCB7eDogMX1dXSxcbiAgICAgICAgICAgICAgICBbMSwgW3t4OiAyfSwge3g6IDN9XV1cbiAgICAgICAgICAgIF0pO1xuXG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoXCJzd2FwXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGFycmF5LCBvdGhlckFycmF5O1xuICAgICAgICBiZWZvcmVFYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGFycmF5ID0gWzEsIDIsIDNdO1xuICAgICAgICB9KTtcbiAgICAgICAgaXQoXCJzaG91bGQgYmUgYWJsZSB0byByZXBsYWNlIGNvbnRlbnQgd2l0aCBjb250ZW50IG9mIGFub3RoZXIgYXJyYXlsaWtlXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIG90aGVyQXJyYXkgPSB7IF9fcHJvdG9fXyA6IEFycmF5LnByb3RvdHlwZSB9O1xuICAgICAgICAgICAgb3RoZXJBcnJheVswXSA9IDQ7XG4gICAgICAgICAgICBvdGhlckFycmF5WzFdID0gNTtcbiAgICAgICAgICAgIG90aGVyQXJyYXkubGVuZ3RoID0gMjtcbiAgICAgICAgICAgIGFycmF5LnN3YXAoMCwgYXJyYXkubGVuZ3RoLCBvdGhlckFycmF5KTtcbiAgICAgICAgICAgIGV4cGVjdChhcnJheSkudG9FcXVhbChbNCwgNV0pO1xuICAgICAgICB9KTtcbiAgICAgICAgaXQoXCJzaG91bGQgaWdub3JlIG5vbiBhcnJheSBsaWtlIHBsdXMgdmFsdWVcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgYXJyYXkuc3dhcCgwLCBhcnJheS5sZW5ndGgsIDQpO1xuICAgICAgICAgICAgZXhwZWN0KGFycmF5KS50b0VxdWFsKFtdKTtcblxuICAgICAgICB9KTtcbiAgICAgICAgaXQoXCJzaG91bGQgaWdub3JlIGV4dHJhIGFyZ3VtZW50c1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBhcnJheS5zd2FwKDAsIGFycmF5Lmxlbmd0aCwgNCwgNSwgNik7XG4gICAgICAgICAgICBleHBlY3QoYXJyYXkpLnRvRXF1YWwoW10pO1xuXG4gICAgICAgIH0pO1xuICAgICAgICBpdChcInNob3VsZCB3b3JrIHdpdGggbGFyZ2UgYXJyYXlzXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIG90aGVyQXJyYXkgPSBuZXcgQXJyYXkoMjAwMDAwKTtcbiAgICAgICAgICAgIGV4cGVjdChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgYXJyYXkuc3dhcCgwLCBhcnJheS5sZW5ndGgsIG90aGVyQXJyYXkpO1xuICAgICAgICAgICAgfSkubm90LnRvVGhyb3coKTtcbiAgICAgICAgICAgIGV4cGVjdChhcnJheS5sZW5ndGgpLnRvRXF1YWwoMjAwMDAwKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGl0KFwic3dhcHMgYXQgYW4gb3V0ZXIgaW5kZXhcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgYXJyYXkuc3dhcCg0LCAwLCBbNV0pO1xuICAgICAgICAgICAgZXhwZWN0KGFycmF5KS50b0VxdWFsKFsxLCAyLCAzLCAsIDVdKTtcbiAgICAgICAgfSk7XG4gICB9KTtcblxuICAgZGVzY3JpYmUoXCJzZXRcIiwgZnVuY3Rpb24gKCkge1xuXG4gICAgICAgaXQoXCJzZXRzIGFuIGlubmVyIGluZGV4XCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgdmFyIGFycmF5ID0gWzEsIDIsIDNdO1xuICAgICAgICAgICBhcnJheS5zZXQoMSwgMTApO1xuICAgICAgICAgICBleHBlY3QoYXJyYXkpLnRvRXF1YWwoWzEsIDEwLCAzXSk7XG4gICAgICAgfSk7XG5cbiAgICAgICBpdChcInNldHMgYW4gaW5uZXIgaW5kZXggb2YgYW4gb2JzZXJ2ZWQgYXJyYXlcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICB2YXIgYXJyYXkgPSBbMSwgMiwgM107XG4gICAgICAgICAgIGFycmF5Lm1ha2VPYnNlcnZhYmxlKCk7XG4gICAgICAgICAgIGFycmF5LnNldCgxLCAxMCk7XG4gICAgICAgICAgIGV4cGVjdChhcnJheSkudG9FcXVhbChbMSwgMTAsIDNdKTtcbiAgICAgICB9KTtcblxuICAgICAgIGl0KFwic2V0cyBhbiBvdXRlciBpbmRleFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgIHZhciBhcnJheSA9IFtdO1xuICAgICAgICAgICBhcnJheS5zZXQoNCwgMTApO1xuICAgICAgICAgICBleHBlY3QoYXJyYXkpLnRvRXF1YWwoWyAsICwgLCAsIDEwXSk7XG4gICAgICAgfSk7XG5cbiAgICAgICBpdChcInNldHMgYW4gb3V0ZXIgaW5kZXggb2YgYW4gb2JzZXJ2ZWQgYXJyYXlcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICB2YXIgYXJyYXkgPSBbXTtcbiAgICAgICAgICAgYXJyYXkubWFrZU9ic2VydmFibGUoKTtcbiAgICAgICAgICAgYXJyYXkuc2V0KDQsIDEwKTtcbiAgICAgICAgICAgZXhwZWN0KGFycmF5KS50b0VxdWFsKFsgLCAsICwgLCAxMF0pO1xuICAgICAgIH0pO1xuXG4gICB9KTtcblxuICAgIGRlc2NyaWJlKFwiZGVsZXRlQWxsXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaXQoXCJzaG91bGQgZGVsZXRlIGEgcmFuZ2Ugb2YgZXF1aXZhbGVudCB2YWx1ZXNcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGFycmF5ID0gWzEsIDEsIDEsIDIsIDIsIDIsIDMsIDMsIDNdO1xuICAgICAgICAgICAgZXhwZWN0KGFycmF5LmRlbGV0ZUFsbCgyKSkudG9CZSgzKTtcbiAgICAgICAgICAgIGV4cGVjdChhcnJheSkudG9FcXVhbChbMSwgMSwgMSwgMywgMywgM10pO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxufSk7XG4iXX0=